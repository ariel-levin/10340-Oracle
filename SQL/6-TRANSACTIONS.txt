CREATE table "TRANSACTIONS" (
    "TRANSACTION_NUM"      NUMBER NOT NULL,
    "TRANSACTION_DATE"     DATE NOT NULL,
    "ITEM_NUM"             NUMBER NOT NULL,
    "TRANSACTION_QUANTITY" NUMBER NOT NULL,
    "TRANSACTION_TYPE"     VARCHAR2(10) NOT NULL,
    "WH_NUM"               NUMBER,
    constraint  "TRANSACTIONS_PK" primary key ("TRANSACTION_NUM")
)
/

CREATE sequence "TRANSACTIONS_SEQ" 
/

CREATE trigger "BI_TRANSACTIONS"  
  before insert on "TRANSACTIONS"              
  for each row 
begin  
  if :NEW."TRANSACTION_NUM" is null then
    select "TRANSACTIONS_SEQ".nextval into :NEW."TRANSACTION_NUM" from dual;
  end if;
end;
/   

ALTER TABLE "TRANSACTIONS" ADD CONSTRAINT "TRANSACTIONS_ITEM_FK" 
FOREIGN KEY ("ITEM_NUM")
REFERENCES "ITEMS" ("ITEM_NUM")

/
ALTER TABLE "TRANSACTIONS" ADD CONSTRAINT "TRANSACTIONS_WH_FK" 
FOREIGN KEY ("WH_NUM")
REFERENCES "WAREHOUSES" ("WH_NUM")
ON DELETE SET NULL

/
