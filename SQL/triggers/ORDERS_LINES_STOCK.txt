create or replace
TRIGGER  "ORDERS_LINES_STOCK" 
BEFORE
insert or update on "ORDERS_LINES"
for each row
begin
DECLARE
	db_quantity NUMBER(32) := 0;
BEGIN
	SELECT NVL(SUM(stock_quantity),0)
	INTO db_quantity
	FROM STOCK
	WHERE item_num = :NEW.item_num;

	IF :NEW.line_quantity > db_quantity THEN
    raise_application_error (-20001,'Item Num: ' || :NEW.item_num || ' >> not enough in stock..');
  END IF;
END;
end;